<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>로그인 ૮ ´͈ ᗜ `͈ ა♡</title>
    <link rel="stylesheet" href="./css/login&zhuche.css">
    <link rel="stylesheet" href="./css/yz.css">
</head>
<body>
<h1>로그인</h1>
    <form id="login-form">
      <label for="login-username">아이디:</label>
      <input type="text" id="login-username" required>
      <br>
      <label for="login-password">비밀번호:</label>
      <input type="password" id="login-password" required>
      <br>
      <label for="login-code">확인코드:<div class="hint_text">이미지 클릭시 확인코드 새로고침</div></label>
      <div class="yz_main">
        <div class="yzbjt"></div>
        <input type="text" placeholder="확인코드를 입력하세요." class="yzinp" id="shuru_yzm">
      </div>
      <button class="login_button">로그인</button><br>
      <a href="index.html" style="font-size: 12px;color:rgb(100, 96, 96); text-decoration: none;">메인 화면으로 가기</a>
      <p id="login-link">계정이 없나요?---><a  href="zhuce.html">회원가입</a></p>
    </form>
    <br><br>
<script>
    document.getElementById('login-form').addEventListener('submit',function(e) {
        e.preventDefault();
        var username = document.getElementById('login-username').value;
        var password = document.getElementById('login-password').value;

        if (localStorage.getItem('login') === 'yes') {
          alert('이미 로그인되었습니다!');
          yzbjt.click();
      } else {
        // localStorage 에서 정보 얻기.
        var localPassword = localStorage.getItem(username);

        if (password === localPassword&&yzbjt.innerHTML == yzinp.value) {
          alert('성공적으로 로그인 되었습니다!');
          localStorage.setItem('login', 'yes');
          window.location.href = "index.html";
          // 입력창 지우기
          document.getElementById('login-username').value = '';
          document.getElementById('login-password').value = '';
        }else if(yzbjt.innerHTML != yzinp.value){
          alert("인증코드를 정확히 입력하세요!!!");
          document.getElementById('shuru_yzm').value = '';
          yzbjt.innerHTML = getCode();
        } else{
          alert('아이디 비번 불일치합니다. 다시입력하세요!!!');
          document.getElementById('login-username').value = '';
          document.getElementById('login-password').value = '';
        }
      }
      });

  var yzbjt = document.querySelector('.yzbjt');
  var yzinp = document.querySelector('.yzinp');
  var login_button = document.querySelector('.login_button');

  var getCode = function() {
    var code = Math.random().toString(36).substr(3, 5);
    return code;
  }

  yzinp.addEventListener('keyup',function(event) {
    event.preventDefault()
    if(event.keyCode === 13) {
      login_button.click();
    }
  })

  yzbjt.onclick = function() {
    yzbjt.innerHTML = getCode();
  }

  yzbjt.click();
</script>
</body>
</html>
<script>

</script>